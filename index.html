<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ethan Leigh-Fellows | Product</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=SF+Pro+Display:wght@300;400;600&family=Raleway:wght@600;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', 'Segoe UI', sans-serif;
            overflow: hidden;
            height: 100vh;
            background: #000;
        }

        /* Preloader */
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }

        #preloader.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 3px solid #333;
            border-top: 3px solid #007AFF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loader-text {
            color: #007AFF;
            margin-top: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            font-size: 14px;
            font-weight: 300;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Video Background */
        #bg-video {
            position: fixed;
            top: 50%;
            left: 50%;
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            transform: translate(-50%, -50%);
            z-index: -2;
            object-fit: cover;
        }

        .video-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            background: rgba(0, 0, 0, 0.3);
            z-index: -1;
        }

        /* Desktop Environment */
        .desktop {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* macOS Menu Bar */
        .menu-bar {
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            padding: 8px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 0.5px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
            height: 32px;
        }

        .menu-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .apple-logo {
            color: #fff;
            font-size: 18px;
            cursor: pointer;
            opacity: 0.9;
        }

        .menu-items {
            display: flex;
            gap: 20px;
            color: #fff;
            font-weight: 400;
            font-size: 13px;
        }

        .menu-items span {
            cursor: pointer;
            opacity: 0.85;
            transition: opacity 0.2s;
        }

        .menu-items span:hover {
            opacity: 1;
        }

        .language-switcher {
            display: flex;
            gap: 10px;
            margin-left: 15px;
        }

        .lang-btn {
            padding: 3px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .lang-btn:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.1);
        }

        .lang-btn.active {
            color: #007AFF;
            border-color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
        }

        .menu-right {
            display: flex;
            align-items: center;
            gap: 15px;
            color: #fff;
            font-size: 12px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: #30d158;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Name Display */
        .name-display {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            z-index: 5;
            pointer-events: none;
        }

        .name-main {
            font-size: 72px;
            font-weight: 700;
            background: linear-gradient(
                to right,
                #007AFF 20%,
                #00D4FF 40%,
                #fff 50%,
                #00D4FF 60%,
                #007AFF 80%
            );
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -2px;
            line-height: 1.4;
            margin-bottom: 0;
            display: inline-block;
            padding-bottom: 10px;
            animation: shine 5s linear infinite;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Inter', sans-serif;
            position: relative;
            cursor: default;
        }

        @keyframes shine {
            to {
                background-position: 200% center;
            }
        }

        .name-main.glitch:hover {
            animation: shine 5s linear infinite, glitch-text 0.3s infinite;
        }

        @keyframes glitch-text {
            0% { transform: translate(0); text-shadow: 2px 0 #ff00c1, -2px 0 #00fff9; }
            25% { transform: translate(-2px, 2px); }
            50% { transform: translate(2px, -2px); text-shadow: -2px 0 #ff00c1, 2px 0 #00fff9; }
            75% { transform: translate(-2px, -2px); }
            100% { transform: translate(0); }
        }

        .name-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.85);
            font-weight: 400;
            letter-spacing: 1px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            animation: fadeInUp 1s ease-out 0.3s both;
            margin-top: -5px;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .terminal-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        #github-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid #007AFF;
            box-shadow: 0 0 15px rgba(0, 122, 255, 0.5);
            display: none;
        }


        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Desktop Icons */
        .desktop-icons {
            position: absolute;
            top: 60px;
            right: 30px;
            display: grid;
            grid-template-columns: repeat(2, 80px);
            gap: 20px;
            z-index: 1;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80px;
            cursor: pointer;
            padding: 8px;
            border-radius: 10px;
            background: transparent;
            transition: all 0.2s ease;
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .desktop-icon.selected {
            background: rgba(0, 122, 255, 0.25);
        }

        .icon-image {
            width: 64px;
            height: 64px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 6px;
            font-size: 36px;
            backdrop-filter: blur(10px);
            border: 0.5px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), 0 0 20px rgba(255, 255, 255, 0.1);
        }

        .desktop-icon:hover .icon-image {
            transform: scale(1.08) translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), 0 0 30px rgba(255, 255, 255, 0.15);
        }

        .desktop-icon:active .icon-image {
            transform: scale(0.95);
        }

        .icon-image.linkedin {
            background: linear-gradient(135deg, #0077b5 0%, #00a0dc 50%, #0077b5 100%);
            border: 1px solid rgba(0, 160, 220, 0.5);
            box-shadow: 0 4px 20px rgba(0, 119, 181, 0.4);
        }

        .icon-image.linkedin i {
            color: #fff;
        }

        .icon-image.github {
            background: linear-gradient(135deg, #6e5494 0%, #8b5cf6 50%, #6e5494 100%);
            border: 1px solid rgba(139, 92, 246, 0.5);
            box-shadow: 0 4px 20px rgba(110, 84, 148, 0.4);
        }

        .icon-image.github i {
            color: #fff;
        }

        .icon-image.contact {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 50%, #f093fb 100%);
            border: 1px solid rgba(245, 87, 108, 0.5);
            box-shadow: 0 4px 20px rgba(240, 147, 251, 0.4);
        }

        .icon-image.contact i {
            color: #fff;
        }

        .icon-image.terminal {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 50%, #4facfe 100%);
            border: 1px solid rgba(0, 242, 254, 0.5);
            box-shadow: 0 4px 20px rgba(79, 172, 254, 0.4);
        }

        .icon-image.terminal i {
            color: #fff;
        }

        .icon-image.music {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 50%, #fa709a 100%);
            border: 1px solid rgba(254, 225, 64, 0.5);
            box-shadow: 0 4px 20px rgba(250, 112, 154, 0.4);
        }

        .icon-image.music i {
            color: #fff;
        }

        .icon-image.hacker {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 50%, #30cfd0 100%);
            border: 1px solid rgba(48, 207, 208, 0.5);
            box-shadow: 0 4px 20px rgba(48, 207, 208, 0.4);
        }

        .icon-image.hacker i {
            color: #fff;
        }

        .icon-label {
            color: #fff;
            font-size: 12px;
            text-align: center;
            text-shadow: 0 1px 4px rgba(0, 0, 0, 0.8);
            user-select: none;
            font-weight: 400;
        }

        /* Main Content Area */
        .content-area {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        /* Window Base Styles */
        .window {
            position: absolute;
            background: rgba(28, 28, 30, 0.85);
            backdrop-filter: blur(40px) saturate(180%);
            -webkit-backdrop-filter: blur(40px) saturate(180%);
            border-radius: 12px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 0.5px solid rgba(255, 255, 255, 0.15);
            z-index: 10;
        }

        .window.active {
            display: flex;
            animation: windowAppear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .window.dragging {
            cursor: move;
            user-select: none;
        }

        @keyframes windowAppear {
            from {
                opacity: 0;
                transform: scale(0.85);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .window-header {
            background: rgba(50, 50, 52, 0.95);
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            border-bottom: 0.5px solid rgba(255, 255, 255, 0.1);
            cursor: move;
            user-select: none;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .window-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .window-btn:hover {
            filter: brightness(1.15);
        }

        .window-btn.close { background: #ff5f57; }
        .window-btn.minimize { background: #febc2e; }
        .window-btn.maximize { background: #28c840; }

        .window-title {
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
            margin-left: 10px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
            font-weight: 400;
        }

        .window-body {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            background: rgba(18, 18, 20, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #fff;
        }

        .window-body::-webkit-scrollbar {
            width: 8px;
        }

        .window-body::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
        }

        .window-body::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        /* Terminal Window */
        #terminal {
            width: 650px;
            height: 450px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        #terminal .window-body {
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            color: #30d158;
            padding: 20px;
        }

        .terminal-line {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .prompt {
            color: #007AFF;
            font-weight: 600;
        }

        .command {
            color: #30d158;
        }

        .repo-list {
            margin-top: 20px;
        }

        .repo-item {
            background: rgba(48, 209, 88, 0.05);
            border-left: 2px solid #30d158;
            padding: 14px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 6px;
        }

        .repo-item:hover {
            background: rgba(48, 209, 88, 0.12);
            transform: translateX(4px);
            border-left-color: #007AFF;
        }

        .repo-name {
            color: #007AFF;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .repo-description {
            color: rgba(255, 255, 255, 0.6);
            font-size: 12px;
            margin-bottom: 8px;
        }

        .repo-meta {
            display: flex;
            gap: 12px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.4);
            flex-wrap: wrap;
        }

        .repo-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .language-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }

        /* Contact Window */
        #contact {
            width: 450px;
            height: 350px;
            top: 20%;
            right: 15%;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(0, 122, 255, 0.1);
            border-radius: 10px;
            transition: all 0.2s ease;
        }

        .contact-item:hover {
            background: rgba(0, 122, 255, 0.2);
            transform: translateX(5px);
        }

        .contact-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 122, 255, 0.3);
            border-radius: 10px;
            font-size: 20px;
            color: #007AFF;
        }

        .contact-text {
            flex: 1;
        }

        .contact-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .contact-value {
            font-size: 15px;
            color: #fff;
            margin-top: 3px;
        }

        .contact-value a {
            color: #007AFF;
            text-decoration: none;
        }

        /* Music Window */
        #music {
            width: 400px;
            height: 240px;
            top: 15%;
            left: 15%;
        }

        #music .window-body {
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.8);
        }

        #music iframe {
            width: 100%;
            border: none;
            border-radius: 12px;
        }

        /* Hacker Window */
        #hacker {
            width: 700px;
            height: 500px;
            top: 20%;
            left: 25%;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #00ff41;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.3);
        }

        #hacker .window-header {
            background: rgba(0, 20, 0, 0.95);
            border-bottom: 1px solid #00ff41;
        }

        #hacker .window-body {
            font-family: 'Courier New', monospace;
            color: #00ff41;
            padding: 20px;
            background: rgba(0, 0, 0, 0.95);
            text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .hacker-ascii {
            font-size: 11px;
            line-height: 1.2;
            white-space: pre;
            text-align: center;
            margin: 30px 0;
            animation: glitch 3s infinite;
        }

        @keyframes glitch {
            0%, 90%, 100% {
                opacity: 1;
                text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
            }
            91%, 93%, 95%, 97% {
                opacity: 0.8;
                text-shadow: 2px 0 5px rgba(0, 255, 65, 0.8), -2px 0 5px rgba(255, 0, 0, 0.5);
            }
        }

        .hacker-text {
            font-size: 14px;
            margin: 8px 0;
            opacity: 0;
            animation: typeIn 0.5s forwards;
            text-align: center;
        }

        @keyframes typeIn {
            to {
                opacity: 1;
            }
        }

        .hacker-text:nth-child(1) { animation-delay: 0.5s; }
        .hacker-text:nth-child(2) { animation-delay: 1s; }
        .hacker-text:nth-child(3) { animation-delay: 1.5s; }
        .hacker-text:nth-child(4) { animation-delay: 4s; }
        .hacker-text:nth-child(5) { animation-delay: 4.5s; }
        .hacker-text:nth-child(6) { animation-delay: 5s; }

        .cursor-blink {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .menu-items {
                display: none;
            }

            .name-main {
                font-size: 48px;
                line-height: 1.3;
                padding-bottom: 10px;
            }

            .name-subtitle {
                font-size: 14px;
                margin-top: 0;
            }

            .desktop-icons {
                grid-template-columns: repeat(3, 70px);
                gap: 15px;
                right: 50%;
                transform: translateX(50%);
                top: auto;
                bottom: 20px;
            }

            .window {
                width: 95vw !important;
                height: 80vh !important;
                top: 10% !important;
                left: 2.5% !important;
                transform: none !important;
            }

            .hacker-ascii {
                font-size: 8px;
            }
        }

        .loading-repos {
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
            text-align: center;
            padding: 20px;
        }

        /* Notifications */
        .notification-container {
            position: fixed;
            top: 45px;
            right: 20px;
            z-index: 10000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none;
        }

        .notification {
            width: 300px;
            background: rgba(30, 30, 30, 0.7);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 0.5px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px 16px;
            color: #fff;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            gap: 12px;
            transform: translateX(350px);
            transition: transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
            pointer-events: auto;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification-icon {
            width: 36px;
            height: 36px;
            background: #007AFF;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            font-size: 13px;
            margin-bottom: 2px;
        }

        .notification-body {
            font-size: 12px;
            opacity: 0.8;
            line-height: 1.4;
        }

        /* Terminal Input */
        .terminal-input-line {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-top: 15px;
            border-top: 1px solid rgba(48, 209, 88, 0.1);
            padding-top: 15px;
        }

        #terminal-input {
            background: transparent;
            border: none;
            color: #30d158;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            flex: 1;
            outline: none;
            width: 100%;
        }

        /* Superuser Mode Theme */
        body.superuser-mode .name-main {
            background: linear-gradient(110deg, #FFD700 0%, #FFA500 25%, #fff 50%, #FFA500 75%, #FFD700 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 20px rgba(255, 215, 0, 0.3);
        }

        body.superuser-mode .lang-btn.active,
        body.superuser-mode .status-dot {
            background: #FFD700;
            color: #000;
            border-color: #FFD700;
        }

        /* System Stats in Menu Bar */
        .system-stats {
            display: flex;
            gap: 15px;
            margin-right: 15px;
            opacity: 0.7;
            font-family: 'SF Mono', monospace;
            font-size: 11px;
        }

        @media (max-width: 1000px) {
            .system-stats { display: none; }
        }
        /* Game Container */
        #game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 10000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
        }

        #game-canvas {
            image-rendering: pixelated;
            max-width: 100%;
            max-height: 100%;
            box-shadow: 0 0 50px rgba(0, 122, 255, 0.2);
        }

        .boot-sequence {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #30d158;
            text-align: left;
            width: 400px;
            pointer-events: none;
        }

        .boot-line {
            margin: 5px 0;
            opacity: 0;
            white-space: pre-wrap;
        }

        @keyframes fadeInLine {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .glitch-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            pointer-events: none;
            display: none;
            z-index: 10001;
        }

        .game-close-btn {
            position: absolute;
            top: 25px;
            right: 25px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            z-index: 10002;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.2);
            opacity: 0;
            pointer-events: none;
        }

        .game-close-btn.show {
            opacity: 1;
            pointer-events: auto;
        }

        .game-close-btn:hover {
            background: #ff5f57;
            border-color: #ff5f57;
            transform: scale(1.1);
        }

        @keyframes glitch-anim {
            0% { transform: translate(0); }
            20% { transform: translate(-5px, 5px); }
            40% { transform: translate(-5px, -5px); }
            60% { transform: translate(5px, 5px); }
            80% { transform: translate(5px, -5px); }
            100% { transform: translate(0); }
        }

        .flag-particle {
            position: fixed;
            pointer-events: none;
            z-index: 20000;
            user-select: none;
            font-size: 2rem;
            animation: flyAcross linear forwards;
            left: 0;
            top: 0;
        }

        @keyframes flyAcross {
            from {
                transform: translate(var(--x-start), var(--y-start)) rotate(0deg);
            }
            to {
                transform: translate(var(--x-end), var(--y-end)) rotate(360deg);
            }
        }

        body.battleship-active #game-container {
            display: flex !important;
            background: #94b9b8a3;
        }
    </style>
</head>
<body>
    <!-- Preloader -->
    <div id="preloader">
        <div class="loader"></div>
        <div class="loader-text" data-i18n="loading">Initializing system...</div>
    </div>

    <!-- Game Container -->
    <div id="game-container">
        <div class="game-close-btn" id="game-close-btn">&times;</div>
        <div class="boot-sequence" id="boot-sequence"></div>
        <canvas id="game-canvas"></canvas>
        <div id="game-music-container"></div>
    </div>
    <div class="glitch-overlay" id="glitch-overlay"></div>

    <!-- Notifications -->
    <div class="notification-container" id="notification-container"></div>

    <!-- Background Video -->
    <video id="bg-video" autoplay muted loop playsinline>
        <source src="background.mp4" type="video/mp4">
    </video>
    <div class="video-overlay"></div>

    <!-- Desktop Environment -->
    <div class="desktop">
        <!-- macOS Menu Bar -->
        <div class="menu-bar">
            <div class="menu-left">
                <div class="apple-logo"></div>
                <div class="menu-items">
                    <span data-i18n="menu.finder">Finder</span>
                    <span data-i18n="menu.file">File</span>
                    <span data-i18n="menu.edit">Edit</span>
                    <span data-i18n="menu.view">View</span>
                </div>
                <div class="language-switcher">
                    <div class="lang-btn active" data-lang="en">EN</div>
                    <div class="lang-btn" data-lang="fr">FR</div>
                    <div class="lang-btn" data-lang="ru">RU</div>
                </div>
            </div>
            <div class="menu-right">
                <div class="system-stats">
                    <span>‚òï <span id="coffee-stat">98%</span></span>
                    <span>üß† <span id="brain-stat">42%</span></span>
                </div>
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span data-i18n="status">Online</span>
                </div>
            </div>
        </div>

        <!-- Name Display -->
        <div class="name-display">
            <div class="name-main glitch" data-i18n="name">Ethan Leigh-Fellows</div>
            <div class="name-subtitle" data-i18n="subtitle">San Francisco | 23 y/o | Product</div>
        </div>

        <!-- Desktop Icons -->
        <div class="desktop-icons">
            <div class="desktop-icon" data-app="terminal">
                <div class="icon-image terminal">
                    <i class="fas fa-terminal"></i>
                </div>
                <div class="icon-label" data-i18n="icon.projects">Projects</div>
            </div>
            <div class="desktop-icon" data-app="hacker">
                <div class="icon-image hacker">
                    <i class="fas fa-user-secret"></i>
                </div>
                <div class="icon-label" data-i18n="icon.access">Access</div>
            </div>
            <div class="desktop-icon" data-app="music">
                <div class="icon-image music">
                    <i class="fas fa-music"></i>
                </div>
                <div class="icon-label" data-i18n="icon.music">Music</div>
            </div>
            <div class="desktop-icon" data-app="contact">
                <div class="icon-image contact">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="icon-label" data-i18n="icon.contact">Contact</div>
            </div>
            <div class="desktop-icon" data-app="linkedin">
                <div class="icon-image linkedin">
                    <i class="fab fa-linkedin"></i>
                </div>
                <div class="icon-label" data-i18n="icon.linkedin">LinkedIn</div>
            </div>
            <div class="desktop-icon" data-app="github">
                <div class="icon-image github">
                    <i class="fab fa-github"></i>
                </div>
                <div class="icon-label" data-i18n="icon.github">GitHub</div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Terminal Window -->
            <div class="window active" id="terminal">
                <div class="window-header">
                    <div class="window-controls">
                        <div class="window-btn close"></div>
                        <div class="window-btn minimize"></div>
                        <div class="window-btn maximize"></div>
                    </div>
                    <span class="window-title" data-i18n="terminal.title">ethan@localhost ‚Äî zsh ‚Äî 80√ó24</span>
                </div>
                <div class="window-body">
                    <div class="terminal-header-content">
                        <div>
                            <div class="terminal-line">
                                <span class="prompt">ethan@localhost</span> <span style="color:#007AFF">~</span> % <span class="command">ls -la repositories/</span>
                            </div>
                            <div class="terminal-line" style="color: rgba(255, 255, 255, 0.5);">
                                <span data-i18n="terminal.fetching">Fetching public repositories from GitHub...</span>
                            </div>
                        </div>
                        <img id="github-avatar" src="" alt="GitHub Avatar">
                    </div>
                    <div class="repo-list" id="repo-list">
                        <div class="loading-repos" data-i18n="terminal.loading">Loading repositories...</div>
                    </div>
                    <div class="terminal-input-line">
                        <span class="prompt">ethan@localhost</span> <span style="color:#007AFF">~</span> % 
                        <input type="text" id="terminal-input" autocomplete="off" spellcheck="false" placeholder="Type 'help' for secrets...">
                    </div>
                </div>
            </div>

            <!-- Hacker Window -->
            <div class="window" id="hacker">
                <div class="window-header">
                    <div class="window-controls">
                        <div class="window-btn close"></div>
                        <div class="window-btn minimize"></div>
                        <div class="window-btn maximize"></div>
                    </div>
                    <span class="window-title" style="color: #00ff41;" data-i18n="hacker.title">[SYSTEM ACCESS] ‚Äî AUTHORIZED</span>
                </div>
                <div class="window-body">
                    <div class="hacker-text" data-i18n="hacker.msg1">> Initiating connection...</div>
                    <div class="hacker-text" data-i18n="hacker.msg2">> Establishing secure link...</div>
                    <div class="hacker-text" data-i18n="hacker.msg3">> Access granted. Welcome, visitor.</div>
                    <div class="hacker-ascii">
‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
‚ñà‚ñà‚ïë ‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  
‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  
‚ïö‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
 ‚ïö‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó                    
‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó    ‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù                    
   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                     
   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë    ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïî‚ïù                      
   ‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù    ‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë                       
   ‚ïö‚ïê‚ïù    ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù     ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù                       

 ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó                 
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó                
‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                
‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó                
‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù                
 ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù                 
                    </div>
                    <div class="hacker-text" data-i18n="hacker.msg4">> Repository access enabled</div>
                    <div class="hacker-text" data-i18n="hacker.msg5">> Decrypting file system...</div>
                    <div class="hacker-text"><span data-i18n="hacker.msg6">> All systems operational</span> <span class="cursor-blink">‚ñà</span></div>
                </div>
            </div>

            <!-- Music Window -->
            <div class="window" id="music">
                <div class="window-header">
                    <div class="window-controls">
                        <div class="window-btn close"></div>
                        <div class="window-btn minimize"></div>
                        <div class="window-btn maximize"></div>
                    </div>
                    <span class="window-title" data-i18n="music.title">Spotify ‚Äî Now Playing</span>
                </div>
                <div class="window-body">
                    <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/album/1HIFwmtC9ah3ujJhAhTL29?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                </div>
            </div>

            <!-- Contact Window -->
            <div class="window" id="contact">
                <div class="window-header">
                    <div class="window-controls">
                        <div class="window-btn close"></div>
                        <div class="window-btn minimize"></div>
                        <div class="window-btn maximize"></div>
                    </div>
                    <span class="window-title" data-i18n="contact.title">Get In Touch</span>
                </div>
                <div class="window-body">
                    <div class="contact-info">
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fab fa-linkedin"></i></div>
                            <div class="contact-text">
                                <div class="contact-label">LinkedIn</div>
                                <div class="contact-value"><a href="https://www.linkedin.com/in/ethan-leigh-fellows/" target="_blank">ethan-leigh-fellows</a></div>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fab fa-github"></i></div>
                            <div class="contact-text">
                                <div class="contact-label">GitHub</div>
                                <div class="contact-value"><a href="https://github.com/ethanleighfellows" target="_blank">@ethanleighfellows</a></div>
                            </div>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
                            <div class="contact-text">
                                <div class="contact-label" data-i18n="contact.location">Location</div>
                                <div class="contact-value" data-i18n="contact.locationValue">San Francisco Bay Area</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/spacecadet/maths.js?v=20260220"></script>
    <script src="js/spacecadet/loader.js?v=20260220"></script>
    <script src="js/spacecadet/render.js?v=20260220"></script>
    <script src="js/spacecadet/physics.js?v=20260220"></script>
    <script src="js/spacecadet/table.js?v=20260220"></script>
    <script src="js/spacecadet/pinball.js?v=20260220"></script>
    <script src="js/pitchybird.js?v=20260220"></script>
    <script src="js/2048.js?v=20260220"></script>
    <script src="js/battleship_game.js?v=20260220"></script>
    <script>
        // Translations
        const translations = {
            en: {
                loading: "Initializing system...",
                menu: { finder: "Finder", file: "File", edit: "Edit", view: "View" },
                status: "Online",
                name: "Ethan Leigh-Fellows",
                subtitle: "San Francisco | 23 y/o | Product",
                icon: { projects: "Projects", access: "Access", music: "Music", contact: "Contact", linkedin: "LinkedIn", github: "GitHub" },
                terminal: { fetching: "Fetching public repositories from GitHub...", loading: "Loading repositories...", updated: "Updated:", title: "ethan@localhost ‚Äî zsh ‚Äî 80√ó24" },
                hacker: {
                    title: "[SYSTEM ACCESS] ‚Äî AUTHORIZED",
                    msg1: "> Initiating connection...",
                    msg2: "> Establishing secure link...",
                    msg3: "> Access granted. Welcome, visitor.",
                    msg4: "> Repository access enabled",
                    msg5: "> Decrypting file system...",
                    msg6: "> All systems operational"
                },
                music: { title: "Spotify ‚Äî Now Playing" },
                contact: { title: "Get In Touch", location: "Location", locationValue: "San Francisco Bay Area" }
            },
            fr: {
                loading: "Initialisation du syst√®me...",
                menu: { finder: "Finder", file: "Fichier", edit: "√âditer", view: "Affichage" },
                status: "En ligne",
                name: "Ethan Leigh-Fellows",
                subtitle: "San Francisco | 23 ans | Product",
                icon: { projects: "Projets", access: "Acc√®s", music: "Musique", contact: "Contact", linkedin: "LinkedIn", github: "GitHub" },
                terminal: { fetching: "R√©cup√©ration des d√©p√¥ts publics depuis GitHub...", loading: "Chargement des d√©p√¥ts...", updated: "Mis √† jour le :", title: "ethan@localhost ‚Äî zsh ‚Äî 80√ó24" },
                hacker: {
                    title: "[ACC√àS SYST√àME] ‚Äî AUTORIS√â",
                    msg1: "> Initialisation de la connexion...",
                    msg2: "> √âtablissement du lien s√©curis√©...",
                    msg3: "> Acc√®s accord√©. Bienvenue, visiteur.",
                    msg4: "> Acc√®s au d√©p√¥t activ√©",
                    msg5: "> D√©chiffrement du syst√®me de fichiers...",
                    msg6: "> Tous les syst√®mes op√©rationnels"
                },
                music: { title: "Spotify ‚Äî En lecture" },
                contact: { title: "Me Contacter", location: "Localisation", locationValue: "R√©gion de San Francisco" }
            },
            ru: {
                loading: "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã...",
                menu: { finder: "Finder", file: "–§–∞–π–ª", edit: "–ü—Ä–∞–≤–∫–∞", view: "–í–∏–¥" },
                status: "–í —Å–µ—Ç–∏",
                name: "–ò—Ç–∞–Ω –õ–∏-–§–µ–ª–ª–æ—É–∑",
                subtitle: "–°–∞–Ω-–§—Ä–∞–Ω—Ü–∏—Å–∫–æ | 23 –≥–æ–¥–∞ | –ü—Ä–æ–¥—É–∫—Ç",
                icon: { projects: "–ü—Ä–æ–µ–∫—Ç—ã", access: "–î–æ—Å—Ç—É–ø", music: "–ú—É–∑—ã–∫–∞", contact: "–ö–æ–Ω—Ç–∞–∫—Ç", linkedin: "LinkedIn", github: "GitHub" },
                terminal: { fetching: "–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —Å GitHub...", loading: "–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤...", updated: "–û–±–Ω–æ–≤–ª–µ–Ω–æ:", title: "–∏—Ç–∞–Ω@localhost ‚Äî zsh ‚Äî 80√ó24" },
                hacker: {
                    title: "[–î–û–°–¢–£–ü –ö –°–ò–°–¢–ï–ú–ï] ‚Äî –ê–í–¢–û–†–ò–ó–û–í–ê–ù",
                    msg1: "> –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è...",
                    msg2: "> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞—â–∏—â—ë–Ω–Ω–æ–π —Å–≤—è–∑–∏...",
                    msg3: "> –î–æ—Å—Ç—É–ø –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω. –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—å.",
                    msg4: "> –î–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω",
                    msg5: "> –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã...",
                    msg6: "> –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç"
                },
                music: { title: "Spotify ‚Äî –°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç" },
                contact: { title: "–°–≤—è–∑–∞—Ç—å—Å—è", location: "–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ", locationValue: "–†–∞–π–æ–Ω –ó–∞–ª–∏–≤–∞ –°–∞–Ω-–§—Ä–∞–Ω—Ü–∏—Å–∫–æ" }
            }
        };

        let currentLang = 'en';

        function updateTranslations(lang) {
            currentLang = lang;
            const t = translations[lang];

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                const keys = key.split('.');
                let value = t;
                for (const k of keys) {
                    value = value[k];
                }
                el.textContent = value;
            });

            // Update language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
            });
        }

        // Language switcher
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const lang = btn.getAttribute('data-lang');
                updateTranslations(lang);
            });
        });

        const languageColors = {
            'JavaScript': '#f1e05a', 'Python': '#3572A5', 'HTML': '#e34c26',
            'CSS': '#563d7c', 'TypeScript': '#2b7489', 'Java': '#b07219',
            'Go': '#00ADD8', 'Rust': '#dea584', 'C++': '#f34b7d',
            'Shell': '#89e051', 'Jupyter Notebook': '#DA5B0B'
        };

        // Preloader
        const preloader = document.getElementById('preloader');
        const video = document.getElementById('bg-video');
        let videoLoaded = false, pageLoaded = false;

        function checkLoadingComplete() {
            if (videoLoaded && pageLoaded) {
                setTimeout(() => {
                    preloader.classList.add('fade-out');
                    setTimeout(() => preloader.style.display = 'none', 500);
                }, 300);
            }
        }

        video.addEventListener('loadeddata', () => {
            videoLoaded = true;
            checkLoadingComplete();
        });

        setTimeout(() => {
            if (!videoLoaded) {
                videoLoaded = true;
                checkLoadingComplete();
            }
        }, 5000);

        window.addEventListener('load', () => {
            pageLoaded = true;
            checkLoadingComplete();
        });

        // Desktop Icon Management
        const desktopIcons = document.querySelectorAll('.desktop-icon');

        desktopIcons.forEach(icon => {
            icon.addEventListener('click', (e) => {
                e.stopPropagation();
                const app = icon.getAttribute('data-app');

                if (app === 'linkedin') {
                    window.open('https://www.linkedin.com/in/ethan-leigh-fellows/', '_blank');
                } else if (app === 'github') {
                    window.open('https://github.com/ethanleighfellows', '_blank');
                } else {
                    openWindow(app);
                }
            });
        });

        document.querySelector('.content-area').addEventListener('click', (e) => {
            if (e.target.classList.contains('content-area')) {
                desktopIcons.forEach(i => i.classList.remove('selected'));
            }
        });

        // Window Management
        function openWindow(windowId) {
            const win = document.getElementById(windowId);
            if (win) {
                win.classList.add('active');
                bringToFront(win);
            }
        }

        function closeWindow(windowId) {
            const win = document.getElementById(windowId);
            if (win) {
                win.style.transition = 'all 0.3s ease';
                win.style.opacity = '0';
                win.style.transform = win.style.transform + ' scale(0.9)';
                setTimeout(() => {
                    win.classList.remove('active');
                    win.style.transition = '';
                    win.style.opacity = '';
                }, 300);
            }
        }

        function minimizeWindow(windowId) {
            const win = document.getElementById(windowId);
            if (win) {
                const currentTransform = win.style.transform || '';
                win.style.transition = 'all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
                win.style.opacity = '0';
                win.style.transform = currentTransform + ' scale(0.1) translateY(100%)';
                setTimeout(() => {
                    win.style.opacity = '1';
                    win.style.transform = currentTransform;
                    win.style.transition = '';
                }, 300);
            }
        }

        function maximizeWindow(windowId) {
            const win = document.getElementById(windowId);
            if (win) {
                const isMaximized = win.style.width === '95vw';
                if (isMaximized) {
                    win.style.width = '';
                    win.style.height = '';
                } else {
                    win.style.width = '95vw';
                    win.style.height = '90vh';
                }
            }
        }

        let zIndex = 10;
        function bringToFront(win) {
            win.style.zIndex = ++zIndex;
        }

        // Window Dragging
        document.querySelectorAll('.window').forEach(win => {
            const header = win.querySelector('.window-header');
            let isDragging = false, currentX, currentY, initialX, initialY, xOffset = 0, yOffset = 0;

            header.addEventListener('mousedown', (e) => {
                if (!e.target.classList.contains('window-btn')) {
                    isDragging = true;
                    const rect = win.getBoundingClientRect();
                    initialX = e.clientX - rect.left;
                    initialY = e.clientY - rect.top;
                    win.classList.add('dragging');
                    bringToFront(win);
                }
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    e.preventDefault();
                    const x = e.clientX - initialX;
                    const y = e.clientY - initialY;
                    win.style.left = x + 'px';
                    win.style.top = y + 'px';
                    win.style.transform = 'none';
                }
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
                win.classList.remove('dragging');
            });
        });

        // Window Controls
        document.querySelectorAll('.window-btn.close').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const win = btn.closest('.window');
                closeWindow(win.id);
            });
        });

        document.querySelectorAll('.window-btn.minimize').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const win = btn.closest('.window');
                minimizeWindow(win.id);
            });
        });

        document.querySelectorAll('.window-btn.maximize').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const win = btn.closest('.window');
                maximizeWindow(win.id);
            });
        });

        // Fetch GitHub Repos
        async function fetchRepositories() {
            const repoList = document.getElementById('repo-list');
            const excludedRepos = ['ethanleighfellows.github.io', 'school'];

            try {
                const response = await fetch('https://api.github.com/users/ethanleighfellows/repos?sort=updated&per_page=100');
                const userResponse = await fetch('https://api.github.com/users/ethanleighfellows');
                if (!response.ok || !userResponse.ok) throw new Error('Failed to fetch');

                const repos = await response.json();
                const userData = await userResponse.json();

                // Display avatar
                const avatarImg = document.getElementById('github-avatar');
                avatarImg.src = userData.avatar_url;
                avatarImg.style.display = 'block';


                const filteredRepos = repos
                    .filter(repo => !repo.fork && !excludedRepos.includes(repo.name.toLowerCase()))
                    .sort((a, b) => new Date(b.updated_at) - new Date(a.updated_at));

                if (filteredRepos.length === 0) {
                    repoList.innerHTML = '<div class="loading-repos" data-i18n="terminal.loading">' + translations[currentLang].terminal.loading + '</div>';
                    return;
                }

                repoList.innerHTML = filteredRepos.map(repo => {
                    const languageColor = languageColors[repo.language] || '#888';
                    return `
                        <div class="repo-item" onclick="window.open('${repo.html_url}', '_blank')">
                            <div class="repo-name">${repo.name}</div>
                            <div class="repo-description">${repo.description || 'No description'}</div>
                            <div class="repo-meta">
                                ${repo.language ? `<span><span class="language-dot" style="background:${languageColor}"></span>${repo.language}</span>` : ''}
                                <span>‚≠ê ${repo.stargazers_count}</span>
                                <span>üî± ${repo.forks_count}</span>
                                <span>${translations[currentLang].terminal.updated} ${new Date(repo.updated_at).toLocaleDateString()}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                repoList.innerHTML = '<div style="color:#ff5f57;text-align:center;padding:20px">Failed to load repositories</div>';
            }
        }

        fetchRepositories();

        // --- New Interaction Features ---

        // Notification System
        function showNotification(title, body, icon = 'fas fa-info-circle') {
            const container = document.getElementById('notification-container');
            const id = 'notif-' + Date.now();
            
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.id = id;
            notif.innerHTML = `
                <div class="notification-icon"><i class="${icon}"></i></div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-body">${body}</div>
                </div>
            `;
            
            container.appendChild(notif);
            
            // Show with slight delay
            setTimeout(() => notif.classList.add('show'), 100);
            
            // Remove after 5s
            setTimeout(() => {
                notif.classList.remove('show');
                setTimeout(() => notif.remove(), 500);
            }, 5000);
        }

        // Terminal Command Logic
        const terminalInput = document.getElementById('terminal-input');
        const repoList = document.getElementById('repo-list');
        let secretsFound = new Set();

        terminalInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const cmd = terminalInput.value.toLowerCase().trim();
                terminalInput.value = '';
                handleCommand(cmd);
            }
        });

        function handleCommand(cmd) {
            if (cmd === 'help') {
                showNotification('System Guide', 'Available: help, clear, whoami, sudo mode, projects, nation. Games: run invader_protocol, run pitchybird, run 2048, run battleship', 'fas fa-terminal');
            } else if (cmd === 'clear') {
                repoList.innerHTML = '<div style="color: rgba(48, 209, 88, 0.3)">Terminal buffer cleared. Reloading repos...</div>';
                setTimeout(fetchRepositories, 1000);
            } else if (cmd === 'whoami') {
                showNotification('User Identity', 'Ethan Leigh-Fellows: Product Enjoyer.', 'fas fa-user');
            } else if (cmd === 'sudo mode') {
                unlockSecret('sudo');
            } else if (cmd === 'projects') {
                openWindow('terminal');
            } else if (cmd === 'coffee') {
                updateStat('coffee', 100);
                showNotification('Refilled', 'Coffee level restored to 100%', 'fas fa-coffee');
            } else if (cmd === 'nation') {
                launchNationEffect();
            } else if (cmd === 'run invader_protocol' || cmd === 'init arcade') {
                launchGame('invader_protocol');
            } else if (cmd === 'run pinball') {
                launchGame('pinball');
            } else if (cmd === 'run pitchybird') {
                launchGame('pitchybird');
            } else if (cmd === 'run 2048') {
                launchGame('2048');
            } else if (cmd === 'run battleship') {
                launchGame('battleship');
            } else {
                showNotification('Error', `Command not found: ${cmd}`, 'fas fa-exclamation-triangle');
            }
        }

        // --- Invader Protocol Game Logic ---

        let gameInstance = null;

        function launchGame(gameType) {
            const gameContainer = document.getElementById('game-container');
            const bootSequence = document.getElementById('boot-sequence');
            const glitchOverlay = document.getElementById('glitch-overlay');
            const musicContainer = document.getElementById('game-music-container');
            const closeBtn = document.getElementById('game-close-btn');
            
            // Blur input and close terminal to prevent keyboard interference
            const terminalInput = document.getElementById('terminal-input');
            if (terminalInput) terminalInput.blur();
            closeWindow('terminal');
            
            gameContainer.style.display = 'flex';
            closeBtn.classList.remove('show');

            let bootLines;
            let GameClass;

            if (gameType === 'invader_protocol') {
                bootLines = [
                    "INITIATING ARCADE_MODULE...",
                    "CHECKING SYSTEM INTEGRITY... [OK]",
                    "ALLOCATING MEMORY... [OK]",
                    "LOADING SPRITE_ASSETS... PROCEDURALLY.",
                    "COMPILING MOTION_CURVES... [DONE]",
                    "CALIBRATING WEAPON_SYSTEMS...",
                    "WARNING: UNKNOWN ENERGY SIGNATURES DETECTED.",
                    "PROTOCOL: INVADER",
                    "LAUNCHING... GOOD LUCK.",
                ];
                GameClass = InvaderProtocol;
            } else if (gameType === 'pinball') {
                bootLines = [
                    "INITIATING PINBALL_SIMULATOR...",
                    "CALIBRATING PHYSICS_ENGINE... [OK]",
                    "LOADING ASSETS... [PLACEHOLDER]",
                    "PREPARING BALL LAUNCH SYSTEM...",
                    "ENGAGING FLIPPER MECHANISMS...",
                    "SIMULATION READY.",
                    "LAUNCHING... HAVE FUN.",
                ];
                GameClass = PinballGame;
            } else if (gameType === 'pitchybird') {
                bootLines = [
                    "INITIATING PITCHYBIRD...",
                    "LOADING PITCHLANE ASSETS...",
                    "CALIBRATING GRAVITY... [OK]",
                    "WAKING UP THE CATS...",
                    "PREPARING EMAIL COLLECTORS...",
                    "SYSTEM READY.",
                    "LAUNCHING... GOOD LUCK.",
                ];
                GameClass = Pitchybird;
            } else if (gameType === '2048') {
                bootLines = [
                    "INITIATING 2048_MODULE...",
                    "PREPARING GRID... [4x4]",
                    "GENERATING SEED TILES...",
                    "CALIBRATING SLIDE_ENGINE...",
                    "MERGE_LOGIC: OPTIMIZED.",
                    "SYSTEM READY.",
                    "LAUNCHING... REACH THE TILE.",
                ];
                GameClass = Game2048;
            } else if (gameType === 'battleship') {
                bootLines = [
                    "INITIATING BATTLESHIP_PROTOCOL...",
                    "SCANNING FOR ENEMY VESSELS...",
                    "CALIBRATING SONAR ARRAYS...",
                    "LOADING COORDINATE_SYSTEM...",
                    "PREPARING SHIP_FLEET...",
                    "SYSTEM READY.",
                    "LAUNCHING... GOOD LUCK, COMMANDER.",
                ];
                GameClass = BattleshipGame;
            } else {
                showNotification('Error', `Unknown game type: ${gameType}`, 'fas fa-exclamation-triangle');
                gameContainer.style.display = 'none';
                openWindow('terminal');
                return;
            }

            bootSequence.innerHTML = '';
            bootLines.forEach((line, index) => {
                setTimeout(() => {
                    const lineEl = document.createElement('div');
                    lineEl.className = 'boot-line';
                    lineEl.textContent = line;
                    bootSequence.appendChild(lineEl);
                    lineEl.style.animation = `fadeInLine 0.5s forwards`;
                    
                    // Glitch effect (only for invader protocol)
                    if (gameType === 'invader_protocol' && index > 4) {
                        glitchOverlay.style.display = 'block';
                        glitchOverlay.style.animation = `glitch-anim 0.1s ${Math.random() > 0.5 ? 'reverse' : ''}`;
                        setTimeout(() => glitchOverlay.style.display = 'none', 100);
                    }
                }, index * 250);
            });

            setTimeout(() => {
                bootSequence.style.display = 'none';
                closeBtn.classList.add('show');
                
                // Add music - Randomly choose a song from the provided list
                const trackUrls = [
                    "https://soundcloud.com/royal-philharmonic-orchestra/knightsbride-march",
                    "https://soundcloud.com/royal-philharmonic-orchestra/nimrod",
                    "https://soundcloud.com/royal-philharmonic-orchestra/crown-imperial",
                    "https://soundcloud.com/royal-philharmonic-orchestra/rule-britannia-2",
                    "https://soundcloud.com/royal-philharmonic-orchestra/jerusalem-2",
                    "https://soundcloud.com/royal-philharmonic-orchestra/auld-lang-syne",
                    "https://soundcloud.com/lucie-507943032/god-save-the-king",
                    "https://soundcloud.com/theroyalairforce-music/battle-of-britain-theme"
                ];
                const selectedTrack = trackUrls[Math.floor(Math.random() * trackUrls.length)];
                musicContainer.innerHTML = `<iframe width="1" height="1" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=${encodeURIComponent(selectedTrack)}&color=%23ff5500&auto_play=true&hide_related=false&show_comments=false&show_user=false&show_reposts=false&show_teaser=false"></iframe>`;
                
                if (gameInstance) {
                    gameInstance.stop(); // Stop previous game instance
                }
                gameInstance = new GameClass('game-canvas');
                gameInstance.start();
            
                // Close button handler
                const closeHandler = () => {
                    gameInstance.stop();
                    closeBtn.removeEventListener('click', closeHandler);
                    document.removeEventListener('keydown', quitHandler); // Remove quit handler here
                    gameContainer.style.display = 'none';
                    bootSequence.style.display = 'block';
                    musicContainer.innerHTML = ''; // Stop music
                    closeBtn.classList.remove('show');
                    openWindow('terminal'); // Restore terminal
                };
                closeBtn.addEventListener('click', closeHandler);
            
                // Add escape key listener to quit
                const quitHandler = (e) => {
                    if (e.key === 'Escape') {
                        if (gameType === 'invader_protocol' && gameInstance.isPaused) {
                            gameInstance.resume();
                        } else if (gameType === 'invader_protocol') {
                            gameInstance.pause();
                        } else { 
                             // For PinballGame or other games, Escape stops the game for now.
                             closeHandler();
                        }
                    }
                };
                document.addEventListener('keydown', quitHandler);
            }, bootLines.length * 250 + 500);
        }
            
                            class InvaderProtocol {
                                constructor(canvasId) {
                                    this.canvas = document.getElementById(canvasId);
                                    this.ctx = this.canvas.getContext('2d');
                                    this.onStop = null;
                                    this.isPaused = false;
                                    
                                    this.width = 800;
                                    this.height = 600;
                                    this.canvas.width = this.width;
                                    this.canvas.height = this.height;
                    
                                    this.audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                                    this.keys = {};
                                    this.player = new Player(this);
                                    this.bullets = [];
                                    this.enemies = [];
                                    this.particles = [];
                                    this.stars = [];
                                    this.powerUps = [];
                                    
                                    this.shakeAmount = 0;
                                    this.enemiesToSpawn = 8;
                                    this.spawnTimer = 0;
                                    this.spawnInterval = 2.0;
                                    
                                    this.enemySpeed = 60;
                                    this.score = 0;
                                    this.highScore = parseInt(localStorage.getItem('invader_high_score')) || 0;
                                    this.wave = 1;
                                    this.lives = 3;
                                    
                                    this.combo = 0;
                                    this.comboTimer = 0;
                                    
                                    this.waveAlpha = 0;
                                    this.showWaveTitle = true;
                                    this.starWarp = 1;
                                    
                                    this.gameOver = false;
                                    this.lastTime = 0;

                                    // Store listener references for removal
                                    this._keydownListener = (e) => {
                                        if (['ArrowLeft', 'ArrowRight', ' ', 'a', 'd', 'Escape'].includes(e.key)) {
                                            e.preventDefault();
                                        }
                                        this.keys[e.key] = true;
                                    };
                                    this._keyupListener = (e) => this.keys[e.key] = false;
                    
                                    this.bindEvents();
                                    this.initStars();
                                }
                    
                                playSound(freq, type, duration, vol) {
                                    if (this.audioCtx.state === 'suspended') this.audioCtx.resume();
                                    const osc = this.audioCtx.createOscillator();
                                    const gain = this.audioCtx.createGain();
                                    osc.type = type;
                                    osc.frequency.setValueAtTime(freq, this.audioCtx.currentTime);
                                    osc.frequency.exponentialRampToValueAtTime(10, this.audioCtx.currentTime + duration);
                                    gain.gain.setValueAtTime(vol, this.audioCtx.currentTime);
                                    gain.gain.exponentialRampToValueAtTime(0.01, this.audioCtx.currentTime + duration);
                                    osc.connect(gain);
                                    gain.connect(this.audioCtx.destination);
                                    osc.start();
                                    osc.stop(this.audioCtx.currentTime + duration);
                                }
                    
                                bindEvents() {
                                    window.addEventListener('keydown', this._keydownListener);
                                    window.addEventListener('keyup', this._keyupListener);
                                }

                                unbindEvents() {
                                    window.removeEventListener('keydown', this._keydownListener);
                                    window.removeEventListener('keyup', this._keyupListener);
                                }
                    
                                initStars() {
                                    for (let i = 0; i < 150; i++) {
                                        this.stars.push(new Star(this));
                                    }
                                }
                    
                                spawnEnemy() {
                                    if (this.enemiesToSpawn > 0) {
                                        const x = Math.random() * (this.width - 100) + 50;
                                        const y = -50;
                                        this.enemies.push(new Enemy(this, x, y));
                                        this.enemiesToSpawn--;
                                    }
                                }
                    
                                applyShake(amount) {
                                    this.shakeAmount = amount;
                                }
                                
                                pause() {
                                    this.isPaused = true;
                                    if (this.audioCtx && this.audioCtx.state === 'running') {
                                        this.audioCtx.suspend();
                                    }
                                }
                    
                                resume() {
                                    this.isPaused = false;
                                    if (this.audioCtx && this.audioCtx.state === 'suspended') {
                                        this.audioCtx.resume();
                                    }
                                    this.gameLoop(this.lastTime);
                                }
                    
                                start() {
                                    this.waveAlpha = 1;
                                    this.gameLoop(0);
                                }
                    
                                stop() {
                                    if (this.gameOver && this.lives > 0) return; // Prevent multiple stops
                                    this.gameOver = true;
                                    this.unbindEvents();
                                    
                                    // Properly close audio context to prevent interference
                                    if (this.audioCtx) {
                                        this.audioCtx.close().catch(err => console.error("Error closing AudioContext:", err));
                                    }
                                    
                                    if (this.onStop) this.onStop();
                                }
                    
                                update(deltaTime) {
                                    if (this.gameOver) return;
                    
                                    if (this.shakeAmount > 0) {
                                        this.shakeAmount -= deltaTime * 20;
                                    } else {
                                        this.shakeAmount = 0;
                                    }
                    
                                    if (this.comboTimer > 0) {
                                        this.comboTimer -= deltaTime;
                                        if (this.comboTimer <= 0) this.combo = 0;
                                    }
                    
                                    if (this.showWaveTitle) {
                                        this.starWarp = Math.min(10, this.starWarp + deltaTime * 20);
                                    } else {
                                        this.starWarp = Math.max(1, this.starWarp - deltaTime * 5);
                                    }
                    
                                    this.stars.forEach(star => star.update(deltaTime, this.starWarp));
                                    this.player.update(deltaTime);
                    
                                    this.spawnTimer += deltaTime;
                                    if (this.spawnTimer >= this.spawnInterval) {
                                        this.spawnEnemy();
                                        this.spawnTimer = 0;
                                    }
                    
                                    if (this.showWaveTitle) {
                                        this.waveAlpha -= deltaTime * 0.5;
                                        if (this.waveAlpha <= 0) this.showWaveTitle = false;
                                    }
                    
                                    for (let i = this.bullets.length - 1; i >= 0; i--) {
                                        this.bullets[i].update(deltaTime);
                                        if (this.bullets[i].y < -20 || this.bullets[i].y > this.height + 20) {
                                            this.bullets.splice(i, 1);
                                        }
                                    }
                    
                                    for (let i = this.enemies.length - 1; i >= 0; i--) {
                                        const enemy = this.enemies[i];
                                        enemy.update(deltaTime);
                                        enemy.x += Math.sin(this.lastTime / 500 + i) * 1.5;
                                        enemy.x = Math.max(20, Math.min(this.width - 20, enemy.x));
                    
                                        if (enemy.y > this.height + 50) {
                                            this.enemies.splice(i, 1);
                                            this.lives--;
                                            this.applyShake(10);
                                            this.playSound(100, 'sawtooth', 0.5, 0.2);
                                            showNotification('HULL BREACH', 'An invader bypassed our defenses!', 'fas fa-exclamation-circle');
                                        }
                                    }
                    
                                    for (let i = this.powerUps.length - 1; i >= 0; i--) {
                                        this.powerUps[i].update(deltaTime);
                                        if (this.powerUps[i].isCollidingWith(this.player)) {
                                            this.player.applyPowerUp(this.powerUps[i].type);
                                            this.powerUps.splice(i, 1);
                                            this.playSound(600, 'sine', 0.3, 0.3);
                                            showNotification('SYSTEM UPGRADE', 'Weapon systems enhanced.', 'fas fa-bolt');
                                        } else if (this.powerUps[i].y > this.height + 20) {
                                            this.powerUps.splice(i, 1);
                                        }
                                    }
                                    
                                    this.checkCollisions();
                    
                                    for (let i = this.particles.length - 1; i >= 0; i--) {
                                        this.particles[i].update(deltaTime);
                                        if (this.particles[i].life <= 0) {
                                            this.particles.splice(i, 1);
                                        }
                                    }
                    
                                    if (this.enemies.length === 0 && this.enemiesToSpawn === 0) {
                                        this.wave++;
                                        this.enemiesToSpawn = 8 + (this.wave * 3);
                                        this.spawnInterval = Math.max(0.4, 2.0 - (this.wave * 0.15));
                                        this.enemySpeed += 25;
                                        this.showWaveTitle = true;
                                        this.waveAlpha = 1;
                                        this.playSound(400, 'square', 0.5, 0.1);
                                    }
                    
                                    if (this.lives <= 0) {
                                        this.endGame();
                                    }
                                }
                    
                                checkCollisions() {
                                    for (let i = this.bullets.length - 1; i >= 0; i--) {
                                        for (let j = this.enemies.length - 1; j >= 0; j--) {
                                            if (this.bullets[i] && this.enemies[j] && this.bullets[i].isCollidingWith(this.enemies[j])) {
                                                this.createExplosion(this.enemies[j].x, this.enemies[j].y, this.enemies[j].color);
                                                this.applyShake(5);
                                                this.playSound(150, 'sawtooth', 0.2, 0.1);
                                                
                                                this.combo++;
                                                this.comboTimer = 2.0;
                                                
                                                if (Math.random() < 0.15) {
                                                    this.powerUps.push(new PowerUp(this, this.enemies[j].x, this.enemies[j].y));
                                                }
                    
                                                const points = 100 * this.wave * Math.min(5, this.combo);
                                                this.score += points;
                                                if (this.score > this.highScore) {
                                                    this.highScore = this.score;
                                                    localStorage.setItem('invader_high_score', this.highScore);
                                                }
                    
                                                this.enemies.splice(j, 1);
                                                this.bullets.splice(i, 1);
                                                break;
                                            }
                                        }
                                    }
                                }
                                
                                endGame() {
                                    if (this.gameOver) return;
                                    this.gameOver = true;
                                    this.applyShake(20);
                                    this.playSound(50, 'sawtooth', 1.0, 0.4);
                                    setTimeout(() => this.stop(), 3000);
                                }
                    
                                createExplosion(x, y, color) {
                                    for (let i = 0; i < 20; i++) {
                                        this.particles.push(new Particle(this, x, y, color));
                                    }
                                }
                                
                                draw() {
                                    this.ctx.save();
                                    if (this.shakeAmount > 0) {
                                        const sx = (Math.random() - 0.5) * this.shakeAmount;
                                        const sy = (Math.random() - 0.5) * this.shakeAmount;
                                        this.ctx.translate(sx, sy);
                                    }
                    
                                    const grad = this.ctx.createRadialGradient(this.width/2, this.height/2, 0, this.width/2, this.height/2, this.width);
                                    grad.addColorStop(0, '#050510');
                                    grad.addColorStop(1, '#000');
                                    this.ctx.fillStyle = grad;
                                    this.ctx.fillRect(-20, -20, this.width + 40, this.height + 40);
                    
                                    this.stars.forEach(star => star.draw());
                                    this.powerUps.forEach(p => p.draw());
                                    this.player.draw();
                                    this.bullets.forEach(b => b.draw());
                                    this.enemies.forEach(e => e.draw());
                                    this.particles.forEach(p => p.draw());
                    
                                    this.ctx.restore();
                                    this.drawHUD();
                                    
                                    if (this.showWaveTitle) {
                                        this.ctx.save();
                                        this.ctx.globalAlpha = this.waveAlpha;
                                        this.ctx.fillStyle = '#fff';
                                        this.ctx.font = "bold 40px 'SF Mono', monospace";
                                        this.ctx.textAlign = 'center';
                                        this.ctx.shadowBlur = 20;
                                        this.ctx.shadowColor = '#007AFF';
                                        this.ctx.fillText(`WAVE ${this.wave}`, this.width/2, this.height/2);
                                        this.ctx.restore();
                                    }
                    
                                    if (this.combo > 1) {
                                        this.ctx.fillStyle = '#FFD700';
                                        this.ctx.font = "bold 14px 'SF Mono', monospace";
                                        this.ctx.textAlign = 'center';
                                        this.ctx.fillText(`${this.combo}X COMBO`, this.player.x, this.player.y - 40);
                                    }
                    
                                    if (this.gameOver && this.lives <= 0) {
                                         this.ctx.fillStyle = 'rgba(0, 0, 0, 0.85)';
                                         this.ctx.fillRect(0, 0, this.width, this.height);
                                         this.ctx.fillStyle = '#ff5f57';
                                         this.ctx.font = "bold 50px 'SF Mono', monospace";
                                         this.ctx.textAlign = 'center';
                                         this.ctx.fillText('CRITICAL FAILURE', this.width / 2, this.height / 2);
                                         this.ctx.font = "20px 'SF Mono', monospace";
                                         this.ctx.fillStyle = '#fff';
                                         this.ctx.fillText(`COMMANDER, YOUR FINAL SCORE: ${this.score.toLocaleString()}`, this.width / 2, this.height / 2 + 60);
                                         this.ctx.font = "16px 'SF Mono', monospace";
                                         this.ctx.fillStyle = '#FFD700';
                                         this.ctx.fillText(`HIGH SCORE: ${this.highScore.toLocaleString()}`, this.width / 2, this.height / 2 + 100);
                                    }
                                }
                    
                                drawHUD() {
                                    this.ctx.save();
                                    this.ctx.fillStyle = 'rgba(10, 10, 30, 0.8)';
                                    this.ctx.fillRect(0, 0, this.width, 60);
                                    this.ctx.strokeStyle = '#007AFF';
                                    this.ctx.lineWidth = 2;
                                    this.ctx.beginPath();
                                    this.ctx.moveTo(0, 60);
                                    this.ctx.lineTo(this.width, 60);
                                    this.ctx.stroke();
                    
                                    this.ctx.fillStyle = '#fff';
                                    this.ctx.font = "bold 16px 'SF Mono', monospace";
                                    this.ctx.textAlign = 'left';
                                    this.ctx.fillText(`INTEL: ${this.score.toLocaleString()}`, 30, 38);
                                    
                                    this.ctx.textAlign = 'right';
                                    this.ctx.fillText(`BEST: ${this.highScore.toLocaleString()}`, this.width - 30, 38);
                                    
                                    this.ctx.textAlign = 'center';
                                    this.ctx.fillText(`SECTOR: ${this.wave}`, this.width/2, 38);
                                    
                                    // Move lives to be next to Score to avoid center overlap
                                    for (let i = 0; i < this.lives; i++) {
                                        this.drawTemplarCross(180 + i * 35, 32, 10, '#007AFF');
                                    }
                                    this.ctx.restore();
                                }
                    
                                drawTemplarCross(x, y, size, color) {
                                    this.ctx.save();
                                    this.ctx.translate(x, y);
                                    this.ctx.fillStyle = color;
                                    for (let i = 0; i < 4; i++) {
                                        this.ctx.beginPath();
                                        this.ctx.moveTo(0, 0);
                                        this.ctx.lineTo(-size/2, -size);
                                        this.ctx.lineTo(size/2, -size);
                                        this.ctx.lineTo(0, 0);
                                        this.ctx.fill();
                                        this.ctx.rotate(Math.PI / 2);
                                    }
                                    this.ctx.restore();
                                }
                    
                                gameLoop(timestamp) {
                                    if (this.gameOver) return;
                                    if (this.isPaused) { this.draw(); return; }
                                    const deltaTime = Math.min((timestamp - this.lastTime) / 1000, 0.1);
                                    this.lastTime = timestamp;
                                    this.update(deltaTime);
                                    this.draw();
                                    requestAnimationFrame(this.gameLoop.bind(this));
                                }
                            }
                    
                            class Star {
                                constructor(game) {
                                    this.game = game;
                                    this.reset(true);
                                }
                                reset(initial = false) {
                                    this.x = Math.random() * this.game.width;
                                    this.y = initial ? Math.random() * this.game.height : -10;
                                    this.layer = Math.floor(Math.random() * 3) + 1;
                                    this.speedBase = this.layer * 60;
                                    this.size = this.layer * 0.8;
                                    this.color = this.layer === 3 ? '#FFD700' : (this.layer === 2 ? '#80A0FF' : '#fff');
                                }
                                update(deltaTime, warp) {
                                    this.y += this.speedBase * warp * deltaTime;
                                    if (this.y > this.game.height) this.reset();
                                }
                                draw() {
                                    this.game.ctx.fillStyle = this.color;
                                    this.game.ctx.beginPath();
                                    this.game.ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                                    this.game.ctx.fill();
                                }
                            }
                    
                            class Player {
                                constructor(game) {
                                    this.game = game;
                                    this.width = 40;
                                    this.x = this.game.width / 2;
                                    this.y = this.game.height - 80;
                                    this.speed = 450;
                                    this.shootCooldown = 0;
                                    this.weaponType = 'standard';
                                    this.powerUpTimer = 0;
                                }
                                applyPowerUp(type) {
                                    this.weaponType = type;
                                    this.powerUpTimer = 8.0;
                                }
                                update(deltaTime) {
                                    if (this.game.keys['ArrowLeft'] || this.game.keys['a']) this.x -= this.speed * deltaTime;
                                    if (this.game.keys['ArrowRight'] || this.game.keys['d']) this.x += this.speed * deltaTime;
                                    this.x = Math.max(30, Math.min(this.game.width - 30, this.x));
                                    
                                    if (this.powerUpTimer > 0) {
                                        this.powerUpTimer -= deltaTime;
                                        if (this.powerUpTimer <= 0) this.weaponType = 'standard';
                                    }
                    
                                    const fireRate = this.weaponType === 'rapid' ? 0.1 : 0.25;
                                    if ((this.game.keys[' '] || this.game.keys['Space']) && this.shootCooldown <= 0) {
                                        this.shoot();
                                        this.shootCooldown = fireRate;
                                        this.game.playSound(500, 'sine', 0.1, 0.1);
                                    }
                                    if (this.shootCooldown > 0) this.shootCooldown -= deltaTime;
                                }
                                shoot() {
                                    if (this.weaponType === 'triple') {
                                        this.game.bullets.push(new Bullet(this.game, this.x, this.y - 20, -1, -0.2));
                                        this.game.bullets.push(new Bullet(this.game, this.x, this.y - 20, -1, 0));
                                        this.game.bullets.push(new Bullet(this.game, this.x, this.y - 20, -1, 0.2));
                                    } else {
                                        this.game.bullets.push(new Bullet(this.game, this.x, this.y - 20, -1, 0));
                                    }
                                }
                                draw() {
                                    this.game.ctx.save();
                                    if (this.weaponType !== 'standard') {
                                        this.game.ctx.shadowBlur = 15;
                                        this.game.ctx.shadowColor = '#FFD700';
                                    }
                                    this.game.drawTemplarCross(this.x, this.y, 20, '#007AFF');
                                    this.game.ctx.restore();
                                    const grad = this.game.ctx.createRadialGradient(this.x, this.y + 15, 0, this.x, this.y + 15, 25);
                                    grad.addColorStop(0, 'rgba(0, 122, 255, 0.5)');
                                    grad.addColorStop(1, 'transparent');
                                    this.game.ctx.fillStyle = grad;
                                    this.game.ctx.beginPath();
                                    this.game.ctx.arc(this.x, this.y + 15, 20, 0, Math.PI * 2);
                                    this.game.ctx.fill();
                                }
                            }
                
                class PowerUp {
                    constructor(game, x, y) {
                        this.game = game;
                        this.x = x;
                        this.y = y;
                        this.type = Math.random() > 0.5 ? 'triple' : 'rapid';
                        this.size = 15;
                        this.color = '#FFD700';
                    }
                    update(deltaTime) { this.y += 120 * deltaTime; }
                    draw() {
                        this.game.ctx.fillStyle = this.color;
                        this.game.ctx.beginPath();
                        this.game.ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                        this.game.ctx.fill();
                        this.game.ctx.fillStyle = '#000';
                        this.game.ctx.font = "bold 12px monospace";
                        this.game.ctx.textAlign = 'center';
                        this.ctxText = this.type === 'triple' ? 'III' : '>>>';
                        this.game.ctx.fillText(this.ctxText, this.x, this.y + 4);
                    }
                    isCollidingWith(player) {
                        const dist = Math.hypot(this.x - player.x, this.y - player.y);
                        return dist < this.size + 20;
                    }
                }
        
                class Enemy {
                    constructor(game, x, y) {
                         this.game = game;
                         this.x = x;
                         this.y = y;
                         this.width = 32;
                         this.rotation = 0;
                         this.rotSpeed = Math.random() * 4 + 2;
                         this.color = '#30d158';
                    }
                    update(deltaTime) {
                        this.y += this.game.enemySpeed * deltaTime;
                        this.rotation += this.rotSpeed * deltaTime;
                    }
                    draw() {
                        this.game.ctx.save();
                        this.game.ctx.translate(this.x, this.y);
                        this.game.ctx.rotate(this.rotation);
                        this.game.ctx.fillStyle = this.color;
                        this.game.ctx.beginPath();
                        for (let i = 0; i < 5; i++) {
                            this.game.ctx.rotate(Math.PI / 5);
                            this.game.ctx.lineTo(0, -this.width / 2);
                            this.game.ctx.rotate(Math.PI / 5);
                            this.game.ctx.lineTo(0, -this.width / 4);
                        }
                        this.game.ctx.closePath();
                        this.game.ctx.fill();
                        this.game.ctx.restore();
                    }
                }
        
                class Bullet {
                    constructor(game, x, y, direction, angle = 0) {
                        this.game = game;
                        this.x = x;
                        this.y = y;
                        this.speed = 650;
                        this.direction = direction;
                        this.vx = angle * this.speed;
                        this.vy = direction * this.speed;
                    }
                    update(deltaTime) {
                        this.x += this.vx * deltaTime;
                        this.y += this.vy * deltaTime;
                    }
                    draw() {
                        this.game.ctx.fillStyle = '#fff';
                        this.game.ctx.shadowBlur = 10;
                        this.game.ctx.shadowColor = '#007AFF';
                        this.game.ctx.fillRect(this.x - 2, this.y - 8, 4, 16);
                        this.game.ctx.shadowBlur = 0;
                    }
                    isCollidingWith(other) {
                        return Math.abs(this.x - other.x) < 20 && Math.abs(this.y - other.y) < 20;
                    }
                }
                
                class Particle {
                    constructor(game, x, y, color) {
                        this.game = game;
                        this.x = x;
                        this.y = y;
                        this.size = Math.random() * 4 + 1;
                        this.life = 1.0;
                        this.vx = (Math.random() - 0.5) * 250;
                        this.vy = (Math.random() - 0.5) * 250;
                        this.color = color;
                    }
                    update(deltaTime) {
                        this.x += this.vx * deltaTime;
                        this.y += this.vy * deltaTime;
                        this.life -= deltaTime * 1.8;
                    }
                    draw() {
                        this.game.ctx.globalAlpha = this.life;
                        this.game.ctx.fillStyle = this.color;
                        this.game.ctx.fillRect(this.x, this.y, this.size, this.size);
                        this.game.ctx.globalAlpha = 1.0;
                    }
                }
        // Secret Tracking
        function unlockSecret(name) {
            if (secretsFound.has(name)) return;
            secretsFound.add(name);
            
            if (name === 'sudo') {
                document.body.classList.add('superuser-mode');
                showNotification('SUPERUSER UNLOCKED', 'Golden theme activated. You found a system secret!', 'fas fa-crown');
                confettiEffect();
            }
            
            if (secretsFound.size >= 3) {
                showNotification('Quest Complete', 'You found all secrets! Welcome to the inner circle.', 'fas fa-check-double');
            }
        }

        // Stats Logic
        function updateStat(id, val) {
            const el = document.getElementById(`${id}-stat`);
            if (el) el.textContent = `${val}%`;
        }

        function launchNationEffect() {
            const flags = ['üá¨üáß', 'üá®üá¶'];
            const container = document.body;
            const count = 50;
            
            showNotification('Allegiance', 'Celebrating the Union Jack and the Maple Leaf!', 'fas fa-flag-checkered');

            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const flag = document.createElement('div');
                    flag.className = 'flag-particle';
                    flag.textContent = flags[Math.floor(Math.random() * flags.length)];
                    
                    const side = Math.floor(Math.random() * 4); // 0: Left, 1: Right, 2: Top, 3: Bottom
                    let xStart, yStart, xEnd, yEnd;
                    const margin = 100;

                    if (side === 0) { // Left to Right
                        xStart = -margin; yStart = Math.random() * window.innerHeight;
                        xEnd = window.innerWidth + margin; yEnd = Math.random() * window.innerHeight;
                    } else if (side === 1) { // Right to Left
                        xStart = window.innerWidth + margin; yStart = Math.random() * window.innerHeight;
                        xEnd = -margin; yEnd = Math.random() * window.innerHeight;
                    } else if (side === 2) { // Top to Bottom
                        xStart = Math.random() * window.innerWidth; yStart = -margin;
                        xEnd = Math.random() * window.innerWidth; yEnd = window.innerHeight + margin;
                    } else { // Bottom to Top
                        xStart = Math.random() * window.innerWidth; yStart = window.innerHeight + margin;
                        xEnd = Math.random() * window.innerWidth; yEnd = -margin;
                    }

                    const duration = 2 + Math.random() * 3;
                    const size = 1.5 + Math.random() * 2.5;

                    flag.style.setProperty('--x-start', `${xStart}px`);
                    flag.style.setProperty('--y-start', `${yStart}px`);
                    flag.style.setProperty('--x-end', `${xEnd}px`);
                    flag.style.setProperty('--y-end', `${yEnd}px`);
                    flag.style.animationDuration = `${duration}s`;
                    flag.style.fontSize = `${size}rem`;
                    flag.style.opacity = 0.8 + Math.random() * 0.2;

                    container.appendChild(flag);

                    setTimeout(() => {
                        flag.remove();
                    }, duration * 1000);
                }, i * 80);
            }
        }

        setInterval(() => {
            // Keep stats at 100%
            updateStat('brain', 100);
            updateStat('coffee', 100);
        }, 1000);

        // Apple Logo Secret
        const appleLogo = document.querySelector('.apple-logo');
        if (appleLogo) {
            appleLogo.addEventListener('click', () => {
                showNotification('System Tip', 'Try typing "sudo mode" in the terminal...', 'fab fa-apple');
            });
        }

        // Simple Confetti
        function confettiEffect() {
            const overlay = document.querySelector('.video-overlay');
            if (overlay) {
                overlay.style.background = 'rgba(255, 215, 0, 0.2)';
                setTimeout(() => overlay.style.background = 'rgba(0, 0, 0, 0.3)', 500);
            }
        }

        // Initial welcome (show only once)
        if (!localStorage.getItem('welcome_shown')) {
            setTimeout(() => {
                showNotification('System Update', 'New zsh features available. Type "help" in terminal.', 'fas fa-robot');
                localStorage.setItem('welcome_shown', 'true');
            }, 3000);
        }
    </script>
</body>
</html>
